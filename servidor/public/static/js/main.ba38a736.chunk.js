(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{205:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(33),s=a.n(o),i=(a(98),a(1)),l=a(4),c=a(7),u=a(5),h=a(6),m=(a(99),a(57)),d=a(30),g=a(18),p=a(39),f=a.n(p),b=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleLoad=function(){a.setState({image:a.image,imageURL:a.image.src,status:a.props.status})},a.handleDragStart=function(e){e.target.setAttrs({shadowOffset:{x:15,y:15},scaleX:1.1,scaleY:1.1})},a.handleDragEnd=function(e){e.target.to({duration:.5,easing:f.a.Easings.ElasticEaseOut,scaleX:1,scaleY:1,shadowOffsetX:5,shadowOffsetY:5}),a.setState({positionX:e.target.attrs.x,positionY:e.target.attrs.y})},a.state={image:null,imageURL:"",positionX:100,positionY:100,rotation:0,status:"",image_id:""},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.loadImage(),this.imageNode.getLayer().batchDraw()}},{key:"componentDidUpdate",value:function(e){e.src!==this.props.src&&this.loadImage()}},{key:"componentWillUnmount",value:function(){this.image.removeEventListener("load",this.handleLoad)}},{key:"loadImage",value:function(){this.image=new window.Image,this.image.src=this.props.src,this.image.crossOrigin="Anonymous",this.image.addEventListener("load",this.handleLoad)}},{key:"render",value:function(){var e=this;this.props.go&&(this.props.salvarImagen(this.state,this.props.status),this.props.goFunction(!1));var t=this.state,a=t.positionX,n=t.positionY,o=t.rotation,s=t.image;return r.a.createElement(g.Image,{x:a,y:n,draggable:!0,rotation:o,shadowBlur:10,shadowOpacity:.6,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,image:s,ref:function(t){e.imageNode=t}})}}]),t}(n.Component),v=a(23),E=a(35),k=a.n(E),O=function e(){var t=this;Object(i.a)(this,e),this.getGallery=function(){return t.service.get("/").then(function(e){return e.data}).catch(function(e){return console.log("Error",e)})},this.getImageGallery=function(e){return t.service.get("/".concat(e)).then(function(e){return e.data}).catch(function(e){return console.log("Error",e)})},this.postImageGallery=function(e){return t.service.post("/addImage/",e).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.postImagePage=function(e){return t.service.post("/addImagePage",e).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.handleUpload=function(e,a){return console.log(e,"----------------------gallery con status--------------"),e.append("status",a),t.service.post("/upload",e).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.service=k.a.create({baseURL:"".concat("https://name-of-your-app.herokuapp.com/","api/galeria"),withCredentials:!0})},y=a(15),j=a(13),S=a.n(j),w=a(17),C=a.n(w),U=a(11),T=a.n(U),I=a(26),x=a.n(I),N=function(e){function t(e){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"card-image"},r.a.createElement("article",{className:"card"},r.a.createElement("img",{className:"card-img-top",src:this.props.imageURL,alt:this.props.name}),r.a.createElement("header",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},this.props.name),r.a.createElement("button",{onClick:function(){return e.props.nuevaImg(e.props.imageURL,e.props.status)}},"Seleccionar imagen"))))}}]),t}(n.Component),B=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e,a))).handleShow=n.handleShow.bind(Object(y.a)(n)),n.handleClose=n.handleClose.bind(Object(y.a)(n)),n.searchImage=n.searchImage.bind(Object(y.a)(n)),n.state={gallery:[],filtered:[],search:"",show:!1,query:""},n.services=new O,n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.services.getGallery().then(function(t){return e.setState({gallery:t})})}},{key:"searchImage",value:function(e){this.setState({query:e.target.value});var t=this.state.gallery.filter(function(t){return t.name.includes(e.target.value)});this.setState({filtered:t})}},{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{variant:"light",onClick:this.handleShow},"Galer\xeda imagenes"),r.a.createElement(S.a,{show:this.state.show,onHide:this.handleClose},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,"Galeria de imagenes")),r.a.createElement(S.a.Body,null,r.a.createElement("form",null,r.a.createElement(T.a,{className:"mb-3"},r.a.createElement(T.a.Prepend,null,r.a.createElement(T.a.Text,{id:"basic-addon1"},"Buscar")),r.a.createElement(x.a,{placeholder:"busca una imagen","aria-label":"gallery","aria-describedby":"basic-addon1",value:this.state.query,onChange:this.searchImage}))),r.a.createElement("div",null,this.state.query.length?this.state.filtered.map(function(t,a){return r.a.createElement(N,Object.assign({key:a,nuevaImg:e.props.nuevaImg,status:e.props.status},t,{go:e.state.go,goFunction:e.go}))}):this.state.gallery.map(function(t,a){return r.a.createElement(N,Object.assign({key:a,nuevaImg:e.props.nuevaImg},t,{go:e.state.go,goFunction:e.go}))})))))}}]),t}(n.Component),P=function e(){var t=this;Object(i.a)(this,e),this.postNewBook=function(e){return t.service.post("/newBook",e).then(function(e){return console.log(e.data),e.data}).catch(function(e){return console.log(e)})},this.postNewPage=function(e){return t.service.post("/addPage",e).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.postNewText=function(e){return t.service.post("/addText",e).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.booksList=function(e){return t.service.get("/",e).then(function(e){return e.data}).catch(function(e){return console.log("Error",e)})},this.UploadPage=function(e,a){return t.service.post("/upload/page/".concat(a),e).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.service=k.a.create({baseURL:"".concat("https://name-of-your-app.herokuapp.com/","api/cuentos"),withCredentials:!0})},L=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(v.a)({},n,r),function(){return console.log(a.state+"soy handleChange")})},a.handleFileUpload=function(e){var t=new FormData;t.append("imageUrl",e.target.files[0]),a.setState({data:t}),console.log(a.props.status)},a.handleSubmit=function(e){console.log("yo soy el primero de handleSubmit  "+a.state.data[0]+"en medio data"),e.preventDefault(),console.log("==========================="),a.services.handleUpload(a.state.data,"background").then(function(e){a.props.nuevaImg(e.imageURL,"background"),a.setState({imageURLBack:e.imageURL})}).catch(function(e){return console.log(e)})},a.handleSubmitChar=function(e){e.preventDefault(),a.services.handleUpload(a.state.data,"character").then(function(e){console.log(e,"estoy en el then de services"),a.props.nuevaImg(e.imageURL,"character"),console.log(e.imageURL,"yo tb estoy en el then, pero despues"),a.setState({imageURLCharDos:e.imageURL})}).catch(function(e){return console.log(e)}),console.log(a.state,a.state.imageURLCharDos,"soy el de teo 2")},a.handleSubmitText=function(e){e.preventDefault(),a.props.nuevaImg(a.state.taleText),a.setState({taleText:a.state.taleText})},a.state={imageURL:"",imageURLChar:"",taleText:"",taleTextColor:"",status:""},a.services=new O,a.servicesBook=new P,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)},className:"toolbar"},r.a.createElement("input",{onChange:this.handleFileUpload,type:"file",name:"imageURL",id:"imageURL",placeholder:"Pega la URL",value:this.state.imageURL,status:"background"})," ",r.a.createElement("br",null),r.a.createElement("button",null,"A\xf1adir fondo"),r.a.createElement("br",null),r.a.createElement(B,{nuevaImg:this.props.nuevaImg,status:"background",go:this.state.go,goFunction:this.go})),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmitChar(t)},className:"toolbar"},r.a.createElement("input",{type:"file",name:"imageURLChar",id:"imageURLChar",placeholder:"Pega la URL",value:this.state.imageURLChar,onChange:this.handleFileUpload,status:"character"}),r.a.createElement("br",null),r.a.createElement("button",null,"A\xf1adir personaje"),r.a.createElement("br",null),r.a.createElement(B,{nuevaImg:this.props.nuevaImg,go:this.state.go,goFunction:this.go,status:"character"})),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmitText(t,"taleText")},className:"toolbar"},r.a.createElement("input",{type:"text",name:"taleText",id:"taleText",placeholder:"Escribe tu cuento",value:this.state.taleText,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("button",null,"Escribe tu cuento"),r.a.createElement("br",null)),r.a.createElement("form",{className:"toolbar"},r.a.createElement("input",{type:"color",name:"taleTextColor",id:"taleTextColor",value:this.state.taleTextColor,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("button",null,"Elige color del texto"),r.a.createElement("br",null)))}}]),t}(n.Component),R=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.props.savePage(),a.props.go(!0)},a.services=new O,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("button",null,"Guarda tu cuento"))}}]),t}(n.Component),D=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleDragStart=function(e){e.target.setAttrs({shadowOffset:{x:0,y:0},scaleX:1.1,scaleY:1.1})},a.handleDragEnd=function(e){e.target.to({duration:.5,easing:f.a.Easings.ElasticEaseOut,scaleX:1,scaleY:1,shadowOffsetX:0,shadowOffsetY:0}),a.setState({positionX:e.target.attrs.x,positionY:e.target.attrs.y})},a.state={content:a.props.text,positionX:100,positionY:100,text_id:a.props._id},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){this.props.go&&(this.props.saveText(this.state),this.props.goFunction(!1));var e=this.state,t=e.content,a=e.positionX,n=e.positionY;return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.Text,{text:t,x:a,y:n,fontSize:20,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,draggable:!0,fill:this.props.color}))}}]),t}(n.Component),F=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.checkNode()}},{key:"componentDidUpdate",value:function(){this.checkNode()}},{key:"checkNode",value:function(){var e=this.transformer.getStage(),t=this.props.selectedShapeName,a=e.findOne("."+t);a!==this.transformer.node()&&(a?this.transformer.attachTo(a):this.transformer.detach(),this.transformer.getGroup().batchDraw())}},{key:"render",value:function(){var e=this;return r.a.createElement(g.Transformer,{ref:function(t){e.transformer=t}})}}]),t}(r.a.Component),_=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleStageClick=function(e){console.log(e.target),console.log(e.target._id),a.setState({selectedShapeName:e.target.name()})},a.addNewImg=function(e,t){var n=Object(d.a)({},a.state.page);"background"===t?n.imageBackground=e:"character"===t?n.imageCharacter.push(e):n.texts.push(e),a.setState({page:n})},a.saveImageToPage=function(e,t){a.services.postImagePage(e).then(function(e){if("background"===e.status)a.setState({pageToSave:Object(d.a)({},a.state.pageToSave,{imageBackground:e._id})});else{var t=Object(m.a)(a.state.pageToSave.imageCharacters);t.push(e._id),a.setState({pageToSave:Object(d.a)({},a.state.pageToSave,{imageCharacters:t})})}})},a.saveTextToPage=function(e){a.servicesBook.postNewText(e).then(function(e){var t=Object(m.a)(a.state.pageToSave.texts);t.push(e._id),a.setState({pageToSave:Object(d.a)({},a.state.pageToSave,{texts:t})})})},a.savePage=function(){setTimeout(function(){console.log(a.state);var e=Object(d.a)({},a.state.pageToSave);e.bookId=a.props.getTheBookId,a.savePageImage(),a.servicesBook.postNewPage(e).then(function(e){a.setState({page:{book:"",texts:[],imageBackground:"",imageCharacter:[],pageNumber:""},pageToSave:{bookId:"",texts:[],imageBackground:void 0,imageCharacters:[]}})})},3e3)},a.go=function(e){a.setState({go:e})},a.handleFileUpload=function(e){var t=new FormData;t.append("imageUrl",e.target.files[0]),a.setState({data:t}),console.log(a.props.status)},a.state={page:{book:"",texts:[],imageBackground:"",imageCharacter:[],pageNumber:""},pageToSave:{bookId:"",texts:[],imageBackground:void 0,imageCharacters:[]},book:{pagesToView:[]},go:!1,selectedShapeName:""},a.services=new O,a.servicesBook=new P,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"savePageImage",value:function(){var e=this.refs.stage.getStage().toDataURL({pixelRatio:2});console.log(this.state.data),this.servicesBook.handleFileUpload(this.state.data,"character").then(function(t){console.log(t,"estoy en el then de services"),console.log(e).catch(function(e){return console.log("Error",e)})})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"flex-editor"},r.a.createElement(L,{nuevaImg:this.addNewImg}),r.a.createElement(R,{go:this.go,savePage:this.savePage,saveToBook:this.savePageImage}),r.a.createElement(g.Stage,{width:window.innerWidth/1.2,height:window.innerHeight/1.2,ref:"stage",onClick:this.handleStageClick},r.a.createElement(g.Layer,null,r.a.createElement(g.Group,{ref:"grupito"},r.a.createElement(b,{src:this.state.page.imageBackground,go:this.state.go,goFunction:this.go,salvarImagen:this.saveImageToPage,status:"background"}),this.state.page.imageBackground?r.a.createElement(b,{src:this.state.page.imageBackground,go:this.state.go,goFunction:this.go,salvarImagen:this.saveImageToPage,status:"background"}):null,this.state.page.imageCharacter.map(function(t,a){return r.a.createElement(b,{key:a,src:t,go:e.state.go,goFunction:e.go,salvarImagen:e.saveImageToPage,status:"character"})}),this.state.page.texts.map(function(t,a){return r.a.createElement(D,{key:a,text:t,go:e.state.go,color:e.state.page.taleTextColor,goFunction:e.go,saveText:e.saveTextToPage})}),r.a.createElement(F,{selectedShapeName:this.state.selectedShapeName})))),r.a.createElement("button",{type:"submit",onClick:this.saveImagesToBook},"Push img"))}}]),t}(n.Component),H=a(36),X=function(){return r.a.createElement(g.Rect,{name:"rectange1",x:20,y:20,width:50,height:50,fill:"red",draggable:!0})},Y=function(){return r.a.createElement(g.Rect,{name:"rectange2",x:60,y:120,width:50,height:50,fill:"green",draggable:!0})},G=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.checkNode()}},{key:"componentDidUpdate",value:function(){this.checkNode()}},{key:"checkNode",value:function(){var e=this.transformer.getStage(),t=this.props.selectedShapeName;console.log(this.props);var a=e.findOne("."+t);a!==this.transformer.node()&&(a?this.transformer.attachTo(a):this.transformer.detach(),this.transformer.getLayer().batchDraw())}},{key:"render",value:function(){var e=this;return r.a.createElement(g.Transformer,{ref:function(t){e.transformer=t}})}}]),t}(r.a.Component),q=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={selectedShapeName:""},a.handleStageClick=function(e){a.setState({selectedShapeName:e.target.name()})},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(g.Stage,{width:window.innerWidth,height:window.innerHeight,onClick:this.handleStageClick},r.a.createElement(g.Layer,null,r.a.createElement(X,null),r.a.createElement(Y,null),r.a.createElement(G,{selectedShapeName:this.state.selectedShapeName})))}}]),t}(r.a.Component),M=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"explain-book"},r.a.createElement("figure",null,r.a.createElement("img",{src:"https://res.cloudinary.com/lulas/image/upload/v1560246748/ilustraciones/fondos%20paisajes/montan%CC%83as-tonos-naranja_labxqa.jpg",alt:"monta\xf1as"}))),r.a.createElement(q,null))}}]),t}(n.Component),A=a(31),W=function e(){var t=this;Object(i.a)(this,e),this.signup=function(e,a,n){return t.service.post("/signup",{username:e,email:a,password:n}).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.login=function(e,a){return console.log(e,a),t.service.post("/login",{username:e,password:a}).then(function(e){return e.data})},this.logout=function(){return t.service.post("/logout",{}).then(function(e){return e.data})},this.loggedin=function(){return t.service.get("/loggedin").then(function(e){return e.data})},this.service=k.a.create({baseURL:"".concat("https://name-of-your-app.herokuapp.com/","auth"),withCredentials:!0})},z=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e,a))).handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState({user:Object(d.a)({},n.state.user,Object(v.a)({},a,r))})},n.handleSubmit=function(e){console.log(n.state.user),e.preventDefault();var t=n.state.user,a=t.username,r=t.email,o=t.password;n.services.signup(a,r,o).then(function(e){n.setState({user:{username:"",email:"",password:""}}),n.props.setTheUser(e),console.log(n.state.user)}).catch(function(e){return console.log(e)})},n.handleShow=n.handleShow.bind(Object(y.a)(n)),n.handleClose=n.handleClose.bind(Object(y.a)(n)),n.state={user:{username:"",email:"",password:""},show:!1},n.services=new W,n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{variant:"light",onClick:this.handleShow},"Registro"),r.a.createElement(S.a,{show:this.state.show,onHide:this.handleClose},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,"Nuevo usuario")),r.a.createElement(S.a.Body,null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(T.a,{className:"mb-3"},r.a.createElement(T.a.Prepend,null,r.a.createElement(T.a.Text,{id:"basic-addon1"},"\u263a")),r.a.createElement(x.a,{as:"input",type:"text",onChange:this.handleChange,value:this.state.user.username,name:"username",placeholder:"Username","aria-label":"Username","aria-describedby":"basic-addon1"})),r.a.createElement(T.a,{className:"mb-3"},r.a.createElement(T.a.Prepend,null,r.a.createElement(T.a.Text,{id:"basic-addon1"},"\u2709")),r.a.createElement(x.a,{as:"input",type:"text",onChange:this.handleChange,value:this.state.user.email,name:"email",placeholder:"example@example.com","aria-label":"email","aria-describedby":"basic-addon1"})),r.a.createElement(T.a,{className:"mb-3"},r.a.createElement(T.a.Prepend,null,r.a.createElement(T.a.Text,{id:"basic-addon1"},"\u270e")),r.a.createElement(x.a,{as:"input",type:"password",onChange:this.handleChange,value:this.state.user.password,name:"password",placeholder:"******","aria-label":"Password","aria-describedby":"basic-addon1"})),r.a.createElement(C.a,{type:"submit",variant:"info",onClick:this.handleClose},"Unirse"))),r.a.createElement(C.a,{variant:"danger ",size:"sm",onClick:this.handleClose},"Cerrar")))}}]),t}(n.Component),J=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e,a))).handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState({user:Object(d.a)({},n.state.user,Object(v.a)({},a,r))})},n.handleSubmit=function(e){e.preventDefault();var t=n.state.user,a=t.username,r=t.password;console.log(a,r),n.services.login(a,r).then(function(e){n.setState({username:"",password:""}),n.props.setTheUser(e)}).catch(function(e){return console.log(e)})},n.handleShow=n.handleShow.bind(Object(y.a)(n)),n.handleClose=n.handleClose.bind(Object(y.a)(n)),n.state={user:{username:"",password:""},show:!1},n.services=new W,n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{variant:"light",onClick:this.handleShow},"Login"),r.a.createElement(S.a,{show:this.state.show,onHide:this.handleClose},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,"Tus datos")),r.a.createElement(S.a.Body,null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(T.a,{className:"mb-3"},r.a.createElement(T.a.Prepend,null,r.a.createElement(T.a.Text,{id:"basic-addon1"},"\u263a")),r.a.createElement(x.a,{as:"input",type:"text",onChange:this.handleChange,value:this.state.user.username,name:"username",placeholder:"Usuario","aria-label":"Username","aria-describedby":"basic-addon1"})),r.a.createElement(T.a,{className:"mb-3"},r.a.createElement(T.a.Prepend,null,r.a.createElement(T.a.Text,{id:"basic-addon1"},"\u270e")),r.a.createElement(x.a,{as:"input",onChange:this.handleChange,value:this.state.user.password,name:"password",type:"password",placeholder:"******","aria-label":"Password","aria-describedby":"basic-addon1"})),r.a.createElement(C.a,{type:"submit",variant:"primary",onClick:this.handleClose},"Entrar"))),r.a.createElement(S.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose},"Cerrar"))))}}]),t}(n.Component),V=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e,a))).setRedirect=function(){n.setState({redirect:!0}),n.handleClose()},n.renderRedirect=function(){if(n.state.redirect)return r.a.createElement(H.a,{to:"/tales-editor"})},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(v.a)({},a,r))},n.handleSubmit=function(e){console.log("submit");var t=n.state.name;e.preventDefault(),n.services.postNewBook({name:t}).then(function(e){console.log(e),n.props.setTheBookId(e._id),n.setState({book_id:e._id})})},n.handleShow=n.handleShow.bind(Object(y.a)(n)),n.handleClose=n.handleClose.bind(Object(y.a)(n)),n.state={name:"",book_id:"",show:!1,redirect:!1},n.services=new P,n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{variant:"light",onClick:this.handleShow},"Crear cuento"),r.a.createElement(S.a,{show:this.state.show,onHide:this.handleClose},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,"Tu cuento")),r.a.createElement(S.a.Body,null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(T.a,{className:"mb-3"},r.a.createElement(T.a.Prepend,null,r.a.createElement(T.a.Text,{id:"basic-addon1"},"\u270e")),r.a.createElement(x.a,{as:"input",type:"text",onChange:this.handleChange,value:this.state.name,name:"name",placeholder:"Las aventuras de unos patos bien locos","aria-label":"name","aria-describedby":"basic-addon1"})),this.renderRedirect(),r.a.createElement(C.a,{type:"submit",variant:"primary",onClick:this.setRedirect},"Crear"))),r.a.createElement(S.a.Footer,null,r.a.createElement(C.a,{variant:"secondary",onClick:this.handleClose},"Cerrar"))))}}]),t}(n.Component),$=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logout=function(){a.service.logout().then(function(e){a.props.setTheUser(null)})},a.service=new W,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",{className:"lis"},r.a.createElement(A.b,{className:"links",to:"/"},r.a.createElement("h3",null,"MuchoCuento"))),r.a.createElement("li",{className:"lis"},r.a.createElement(A.b,{className:"links",to:"/"},r.a.createElement(C.a,null,"Home"))),r.a.createElement("li",{className:"lis"},r.a.createElement(V,{setTheBookId:this.props.setTheBookId})),this.props.user?r.a.createElement("li",{className:"lis"},r.a.createElement(C.a,{onClick:this.logout},"Logout ")):r.a.createElement("li",{className:"lis"},r.a.createElement(z,{setTheUser:this.props.setTheUser})," ",r.a.createElement(J,{setTheUser:this.props.setTheUser})," "),this.props.user?r.a.createElement("li",null," ",r.a.createElement(A.b,{to:"/prof/private/profile/".concat(this.props.user._id),className:"links"}," Perfil")," "):null))}}]),t}(n.Component),K=function e(){var t=this;Object(i.a)(this,e),this.uploadProfile=function(e,a){return console.log("Services, mira a ver el id",a),t.service.post("/private/profile/".concat(a),e).then(function(e){return e.data}).catch(function(e){return console.log(e)})},this.service=k.a.create({baseURL:"".concat("https://name-of-your-app.herokuapp.com/","prof"),withCredentials:!0})},Q=a(208),Z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).setRedirect=function(){a.setState({redirect:!0}),setTimeout(function(){a.renderRedirect()},1e3)},a.renderRedirect=function(){if(a.state.redirect)return r.a.createElement(H.a,{to:"/"})},a.state={redirect:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"card-image"},r.a.createElement("article",{className:"card"},r.a.createElement("header",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},this.props.name),r.a.createElement(Q.a,{variant:"outline-success",onClick:this.setRedirect},"Leer cuento"))))}}]),t}(n.Component),ee=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e,a))).handleShow=n.handleShow.bind(Object(y.a)(n)),n.handleClose=n.handleClose.bind(Object(y.a)(n)),n.searchBook=n.searchBook.bind(Object(y.a)(n)),n.state={books:[],searchBook:[],search:"",show:!1,query:""},n.services=new P,n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.services.booksList().then(function(t){return e.setState({books:t})})}},{key:"searchBook",value:function(e){this.setState({query:e.target.value});var t=this.state.books.filter(function(t){return t.name.includes(e.target.value)});this.setState({searchBook:t})}},{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{className:"horror-button",variant:"light",onClick:this.handleShow},"Buscar cuentos"),r.a.createElement(S.a,{show:this.state.show,onHide:this.handleClose},r.a.createElement(S.a.Header,{closeButton:!0},r.a.createElement(S.a.Title,null,"Todos los cuentos")),r.a.createElement(S.a.Body,null,r.a.createElement(T.a,{className:"mb-3"},r.a.createElement(T.a.Prepend,null,r.a.createElement(T.a.Text,{id:"basic-addon1"},"\u2328")),r.a.createElement(x.a,{placeholder:"Buscar cuentos","aria-label":"books","aria-describedby":"basic-addon1",value:this.state.query,onChange:this.searchBook})),r.a.createElement("div",null,this.state.query.length?this.state.searchBook.map(function(e,t){return r.a.createElement(Z,Object.assign({key:t},e))}):this.state.books.map(function(e,t){return r.a.createElement(Z,Object.assign({key:t},e))})))))}}]),t}(n.Component),te=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(v.a)({},n,r))},a.handleFileUpload=function(e){var t=new FormData;t.append("imageUrl",e.target.files[0]);var n=!0,r=!1,o=void 0;try{for(var s,i=t.entries()[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var l=s.value;console.log(l[0]),console.log(l[1])}}catch(c){r=!0,o=c}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}a.setState({data:t})},a.handleSubmit=function(e){e.preventDefault(),a.services.uploadProfile(a.state.data,a.state.user_id).then(function(e){console.log(e),a.setState(Object(d.a)({},a.state,{profilePhoto:e.profilePhoto}))})},a.handleUser=function(e){e.preventDefault()},a.state={user_id:a.props.user.user_id,profilePhoto:a.props.user.profilePhoto,username:a.props.user.username,email:a.props.user.email},console.log(a.props.user.user_id),a.services=new K,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("figure",{className:"profile-photo"},r.a.createElement("img",{src:this.state.profilePhoto,alt:"profile-images"})),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t,"imageURL")},className:"toolbar"},r.a.createElement("input",{onChange:this.handleFileUpload,type:"file",name:"imageURL",id:"imageURL",placeholder:"Elige imagen"})," ",r.a.createElement("br",null),this.state.data&&r.a.createElement(Q.a,{type:"submit"},"Cambiar imagen de perfil"),r.a.createElement("br",null)),r.a.createElement("form",{onSubmit:this.handleUser},r.a.createElement("label",null," Cambiar nombre de usuario ",r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"username",value:this.state.username,placeholder:this.state.username,onChange:this.handleChange})),r.a.createElement("br",null),r.a.createElement("label",null," Cambiar email",r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"email",value:this.state.email,placeholder:this.state.email,onChange:this.handleChange})),r.a.createElement("br",null),r.a.createElement("button",null,"Guardar cambios")),r.a.createElement(Q.a,{onClick:this.props.close},"Cerrar"))}}]),t}(n.Component),ae=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(v.a)({},n,r))},a.handleFileUpload=function(e){var t=new FormData;t.append("imageUrl",e.target.files[0]),a.setState({data:t})},a.handleSubmit=function(e){e.preventDefault(),a.services.uploadProfile(a.state.data).then(function(e){a.setState({profilePhoto:e.imageURL}),a.services.updatePhoto(a.state.profilePhoto,a.state.user_id).then(function(e){return console.log(e)})})},a.handleShow=function(){a.setState({show:!0})},a.handleClose=function(){a.setState({show:!1})},a.state={user_id:a.props.loggedInUser._id,profilePhoto:a.props.loggedInUser.profilePhoto,username:a.props.loggedInUser.username,email:a.props.loggedInUser.email,password:a.props.loggedInUser.password,show:!1},a.services=new K,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Bienvenido, ",this.props.loggedInUser.username),r.a.createElement("div",{className:"user-info"},r.a.createElement(Q.a,{className:"horror-button",onClick:this.handleShow},"Informaci\xf3n de usuario"),this.state.show?r.a.createElement(te,{user:this.state,close:this.handleClose}):null,r.a.createElement(ee,null)))}}]),t}(n.Component),ne=a(93),re=function(e){var t=e.component,a=e.user,n=Object(ne.a)(e,["component","user"]);return r.a.createElement(H.b,Object.assign({},n,{render:function(e){return a?r.a.createElement(t,Object.assign({},e,{loggedInUser:a})):r.a.createElement(H.a,{to:{pathname:"/"}})}}))},oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).setUser=function(e){return a.setState({loggedInUser:e})},a.fetchUser=function(){null===a.state.loggedInUser&&a.services.loggedin().then(function(e){return a.setState({loggedInUser:e})}).catch(function(e){return a.setState({loggedInUser:!1})})},a.setTheBookId=function(e){a.setState({bookId:e})},a.getTheBookId=function(){return a.state.bookId},a.state={loggedInUser:null,bookId:void 0},a.services=new W,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.fetchUser(),r.a.createElement("main",null,r.a.createElement($,{setTheBookId:this.setTheBookId,setTheUser:this.setUser,user:this.state.loggedInUser}),r.a.createElement(H.d,null,r.a.createElement(H.b,{path:"/",exact:!0,component:M}),r.a.createElement(H.b,{path:"/tales-editor",exact:!0,render:function(){return r.a.createElement(_,{user:e.state.loggedInUser,getTheBookId:e.state.bookId})}}),r.a.createElement(re,{path:"/prof/private/profile/:_id",exact:!0,component:ae,user:this.state.loggedInUser,setTheUser:this.setUser})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(A.a,null,r.a.createElement(oe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},94:function(e,t,a){e.exports=a(205)},98:function(e,t,a){},99:function(e,t,a){}},[[94,1,2]]]);
//# sourceMappingURL=main.ba38a736.chunk.js.map